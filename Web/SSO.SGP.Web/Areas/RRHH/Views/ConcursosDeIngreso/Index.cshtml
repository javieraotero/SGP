@using Syncrosoft.Framework.Controles.MVC.Script;
@using Syncrosoft.Framework.Controles.Mvc.JQuery.Datatables;
@using SSO.SGP.Web.Areas.RRHH.Controllers;
@using Syncrosoft.Framework.Controles.MVC;
@using SSO.SGP.EntidadesDeNegocio.Vistas;
@model SSO.SGP.EntidadesDeNegocio.ConcursosDeIngreso

<!--
    CODE GENERATED BY Xeus Technology
    Date:  15/03/2018 10:52:11
    Version: 3
-->
@{
    Layout = null;
    var hash = "form" + Session.GetHashCode();
    var value = "";
}
<!-- SCRIPTS -->
<!-- <script src="ts/ConcursosDeIngreso/Index.js"></script> -->
<!-- /SCRIPTS -->

@using (Html.BeginForm("Index", "ConcursosDeIngreso", FormMethod.Post, new { id = hash }))
{
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            @{
                ColumnCommand[] operadoresConcursosDeIngreso = new ColumnCommand[5] {

                     new ColumnCommand {
                        display = "editar",
                        function = "oConcursosDeIngreso.editar_dtConcursosDeIngreso(this)",
                        icon = "../assets/img/icons/16x16/edit.png",
                        tooltip = "Editar este registro"
                     },

                     new ColumnCommand {
                        display = "eliminar",
                        function = "oConcursosDeIngreso.eliminar_dtConcursosDeIngreso(this)",
                        icon = "../assets/img/icons/16x16/delete.png",
                        tooltip = "Eliminar este registro"
                     },

                     new ColumnCommand {
                        display = "inscriptos",
                        function = "oConcursosDeIngreso.inscriptos_dtConcursosDeIngreso(this)",
                        icon = "../assets/img/icons/16x16/vendedor.fw.png",
                        tooltip = "ver inscriptos"
                     },
                     new ColumnCommand {
                        display = "notificar",
                        function = "oConcursosDeIngreso.enviar_dtConcursosDeIngreso(this)",
                        icon = "../assets/img/icons/16x16/mail.png",
                        tooltip = "evaluaciones"
                     },
                     new ColumnCommand {
                        display = "evaluaciones",
                        function = "oConcursosDeIngreso.evaluaciones_dtConcursosDeIngreso(this)",
                        icon = "../assets/img/evaluacion.png",
                        tooltip = "Evaluaciones del concurso"
                     },
                                     };
                var vmConcursosDeIngreso = Html.DataTableVm("dtConcursosDeIngreso", (ConcursosDeIngresoController h) => h.getConcursosDeIngresoGrid(null));
                vmConcursosDeIngreso.operators = operadoresConcursosDeIngreso;
                vmConcursosDeIngreso.OpcionesEnGrilla = true;
                //vmConcursosDeIngreso.fnDrawCallBack = "render_dtConcursosDeIngreso(this);";
                vmConcursosDeIngreso.ColumnFilter = true;
                //vmConcursosDeIngreso.FilterOn("activo").Select("Si", "No");
                vmConcursosDeIngreso.CantidadRegistrosDefault = 25;
            }
            @Html.Partial("~/Views/Shared/DataTable.cshtml", vmConcursosDeIngreso)
            <input type="hidden" id="SelectedConcursosDeIngreso@(hash)" value="" />
        </div>

    </div>


    <div class="form-actions">

        <input type="button" value="Generar Excel con Confirmados" id="ImprimirConfirmados" name="Cancelar" class="btn blue" />

        <input type="button" value="Generar Excel con Todos" id="ImprimirTodos" name="Guardar" class="btn green" />

        <input type="button" value="Corregir exámenes sin finalizar" id="ImprimirConfirmados" name="Cancelar" class="btn blue" />

        @*<input type="button" value="GuardarYNuevo" id="GuardarYNuevo@(hash)" name="GuardarYNuevo" class="btn blue" />*@
    </div><!--fin form-actions>-->
</div>
}
<script type="text/javascript">
    $(function () {
        app.Desbloquear();
    });
	var viewIndex = new ConcursosDeIngreso.ts.Index("@(hash)");
    oConcursosDeIngreso.setIndex(viewIndex);
    viewIndex.setConcursosDeIngreso(dtConcursosDeIngreso);

    $(function () {
        $("#ImprimirConfirmados").click(function (e) {
            e.preventDefault();
            if (oConcursosDeIngreso.ViewIndex.ConcursosDeIngreso_id) {
                var sql = "select apellido, nombres, dni, domicilio, ciudad, email, telefono from concursosdeingresoinscripcionesexcel where fecharecepcion is not null and concursodeingreso = " + oConcursosDeIngreso.ViewIndex.ConcursosDeIngreso_id;
                var concurso = oConcursosDeIngreso.ViewIndex.getData_ConcursosDeIngreso(1);
                window.open("/rrhh/reportes/excelcontitulo/?query=" + sql + "&filename=Inscriptos&titulo=Inscriptos confirmados: " + concurso  );
            } else {
                app.crearNotificacionError("Error", "Para generar el excel debe seleccionar un concurso");
            }

        });

        $("#ImprimirTodos").click(function (e) {
            e.preventDefault();
            if (oConcursosDeIngreso.ViewIndex.ConcursosDeIngreso_id) {
                var sql = "select apellido, nombres, dni, domicilio, ciudad, email, telefono from concursosdeingresoinscripcionesexcel where concursodeingreso = " + oConcursosDeIngreso.ViewIndex.ConcursosDeIngreso_id;
                var concurso = oConcursosDeIngreso.ViewIndex.getData_ConcursosDeIngreso(1);
                window.open("/rrhh/reportes/excelcontitulo/?query=" + sql + "&filename=Inscriptos&titulo=Preinscriptos: " + concurso);
            } else {
                app.crearNotificacionError("Error", "Para generar el excel debe seleccionar un concurso");
            }

        });
    });

</script>