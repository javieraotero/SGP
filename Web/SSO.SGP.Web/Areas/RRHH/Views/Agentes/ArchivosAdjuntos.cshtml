@using Syncrosoft.Framework.Controles.MVC.Script;
@using Syncrosoft.Framework.Controles.Mvc.JQuery.Datatables;
@using SSO.SGP.Web.Areas.RRHH.Controllers;
@using Syncrosoft.Framework.Controles.MVC;
@using SSO.SGP.EntidadesDeNegocio.Vistas;
@model int

    <!--
        CODE GENERATED BY Xeus Technology
        Date:  28/07/2016 22:02:35
        Version: 3
    -->
    @{
        Layout = null;
        var hash = "form" + Session.GetHashCode();
        var value = "";
    }
    
    <script src="/ts/ArchivosAdjuntos/Index.js"></script> 
    <script src="/ts/ArchivosAdjuntos/ArchivosAdjuntosManager.js"></script> 
    

    @using (Html.BeginForm("Index", "ArchivosAdjuntos", FormMethod.Post, new { id = hash }))
    {
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="alert alert-info">
                        Total de Archivos Adjuntos: <strong>@(new SSO.SGP.AccesoADatos.ImagenesrrhhAD().ObtenerPorAgente(Model).Count())</strong>
                        <a id="NuevoArchivo" class="btn blue" style="float:right;margin-bottom:20px !important" href="#"><i class="fa fa-plus"></i> Nuevo Adjunto</a>                   
                    </div>                
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-12">
                    @{
                        ColumnCommand[] operadoresArchivosAdjuntos = new ColumnCommand[2] {
                             new ColumnCommand {
                                display = "abrir",
                                function = "oArchivosAdjuntos.abrir_dtArchivosAdjuntos("+Model+")",
                                icon = "../assets/img/icons/16x16/detail.fw.png",
                                tooltip = "Editar este registro"
                             },

                             new ColumnCommand {
                                display = "eliminar",
                                function = "oArchivosAdjuntos.eliminar_dtArchivosAdjuntos()",
                                icon = "../assets/img/icons/16x16/delete.png",
                                tooltip = "Eliminar este registro"
                             },
                          };
                        // var id = int.Parse(ViewBag.Id.ToString());
                        var vmArchivosAdjuntos = Html.DataTableVm("dtArchivosAdjuntos", (AgentesController h) => h.getAdjuntosAgenteGrid(null, Model), "id="+Model.ToString());
                        vmArchivosAdjuntos.operators = operadoresArchivosAdjuntos;
                        vmArchivosAdjuntos.OpcionesEnGrilla = true;
                        //vmArchivosAdjuntos.fnDrawCallBack = "render_dtArchivosAdjuntos(this);";
                        vmArchivosAdjuntos.ColumnFilter = true;
                        //vmArchivosAdjuntos.FilterOn("activo").Select("Si", "No");
                        vmArchivosAdjuntos.CantidadRegistrosDefault = 25;
                    }
                    @Html.Partial("~/Views/Shared/DataTable.cshtml", vmArchivosAdjuntos)
                    <input type="hidden" id="SelectedArchivosAdjuntos@(hash)" value="" />
                </div>

            </div>
            <div class="form-actions">
            </div><!--fin form-actions>-->
        </div>
                        }
    <script type="text/javascript">
        $(function () {
            app.Desbloquear();

            $("#NuevoArchivo").click(function (e) {
                e.preventDefault();
                app.modal.cargar("Nuevo Adjunto", "/ArchivosAdjuntos/FileAgente/?agente=@Model")
            });
        });

        //if (!oArchivosAdjuntos)
        //    var oArchivosAdjuntos = new ArchivosAdjuntos.ts.ArchivosAdjuntosManager();

        var viewIndex = new ArchivosAdjuntos.ts.Index("@(hash)");
        oArchivosAdjuntos.setIndex(viewIndex);
        viewIndex.setArchivosAdjuntos(dtArchivosAdjuntos);



    </script>