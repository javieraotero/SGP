@using Syncrosoft.Framework.Controles.MVC.Script;
@using Syncrosoft.Framework.Controles.Mvc.JQuery.Datatables;
@using SSO.SGP.Web.Areas.Expedientes.Controllers
@using Syncrosoft.Framework.Controles.MVC;
@using SSO.SGP.EntidadesDeNegocio.Vistas;
@model SSO.SGP.EntidadesDeNegocio.SolicitudesDeViaticosRendiciones    

<!--
    CODE GENERATED BY Xeus Technology
    Date:  13/12/2018 7:26:22
    Version: 3
-->
@{
    Layout = null;
    var hash = "form" + Session.GetHashCode();
    var value = "";
}

<script src="@Url.Content("~/assets/plugins/bootstrap-switch/static/js/bootstrap-switch.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/assets/plugins/chosen-bootstrap/chosen/chosen.jquery.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/assets/plugins/tinymce/js/tinymce/tinymce.min.js")" type="text/javascript"></script>
<link rel="stylesheet" href="@Url.Content("~/assets/plugins/bootstrap-switch/static/stylesheets/bootstrap-switch.min.css")" />
<link rel="stylesheet" href="@Url.Content("~/assets/plugins/chosen-bootstrap/chosen/chosen.css")" />
@Scripts.Render("~/bundles/jqueryval")
<script src="Areas/Expedientes/ts/SolicitudesDeViaticos/CrearRendicion.js"></script>

<script src="ts/Syncro/SyncroModal.js"></script>
<script src="ts/Syncro/SyncroAutocomplete.js"></script>
<script src="~/Scripts/moment.js"></script>

@using (Html.BeginForm("Crear", "SolicitudesDeViaticos", FormMethod.Post, new { id = hash }))
{
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3">
                <div class="control-group">
                    <label class="control-label" for="Fecha">Fecha</label>
                    <div class="controls">
                        <div class="input-append date date-picker" data-date-format="dd-mm-yyyy" data-date-viewmode="years">
                            <input type="text" class="form-control col-md-12 date-picker" disabled="disabled" id="Fecha@(hash)" tabindex="2" name="Fecha" value="@DateTime.Now.ToShortDateString()" />
                            <span class="add-on"><i class="icon-calendar"></i></span>
                        </div>
                        <script type="text/javascript">
                            @*$(function () {
                                //$('#Fecha@(hash)').datepicker(pickerOpts);
                                $('#Fecha@(hash)').datetimepicker({
                                    viewMode: 'years'
                                });
                            });*@
                        </script>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="control-group">
                    <label class="control-label" for="OrganismoSolicitante">Organismo Solicitante</label>
                    <div class="controls">
                        <input type="text" class="form-control col-md-12" id="OrganismoSolicitanteText@(hash)" name="OrganismoSolicitanteText" disabled="disabled" tabindex="3" value="@ViewBag.Organismo" )" />
                        <input type="hidden" id="OrganismoSolicitante@(hash)" name="OrganismoSolicitante" value="@ViewBag.Organismo" />
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <div class="control-group">
                    <label class="control-label" for="FechaDeInicio">Fecha y Hora de Inicio</label>
                    <div class="controls">
                        <div class="input-append date date-picker" data-date="12-02-2012" data-date-format="dd-mm-yyyy" data-date-viewmode="years">
                            <input type="text" class="form-control col-md-12 date-picker" id="FechaDeInicio@(hash)" tabindex="5" name="FechaDeInicio" value="@Model.FechaDeInicio.ToString("yyyy-MM-dd HH:mm")" />
                            <span class="add-on"><i class="icon-calendar"></i></span>
                        </div>
                        <script type="text/javascript">
                            $(function () {
                                //$('#Fecha@(hash)').datepicker(pickerOpts);
                                $('#FechaDeInicio@(hash)').datetimepicker({
                                    viewMode: 'years'
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="control-group">
                    <label class="control-label" for="FechaDeFin">Fecha y Hora de Fin</label>
                    <div class="controls">
                        <div class="input-append date date-picker" data-date-format="dd-mm-yyyy" data-date-viewmode="years">
                            <input type="text" class="form-control col-md-12 date-picker" id="FechaDeFin@(hash)" tabindex="6" name="FechaDeFin" value="@Model.FechaDeFin.ToString("yyyy-MM-dd HH:mm")" />
                            <span class="add-on"><i class="icon-calendar"></i></span>
                        </div>
                        <script type="text/javascript">
                            $(function () {
                                //$('#Fecha@(hash)').datepicker(pickerOpts);
                                $('#FechaDeFin@(hash)').datetimepicker({
                                    viewMode: 'years'
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>

        <br />
        <div class="row">
            <div class="col-md-12">
                <div class="control-group">
                    <label class="control-label" for="Estado">Imputación Presupuestaria</label>
                    <div class="controls">
                        <table class="table table-advance table-bordered">
                            <tbody id="body_partidas@(hash)">
                                <tr>
                                    <td>Bienes de Consumo</td>
                                    <td><span id="TotalBienesDeConsumo@(hash)"></span></td>
                                </tr>
                                <tr>
                                    <td>Servicios no Personales</td>
                                    <td><span id="TotalServiciosNoPersonales@(hash)"></span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!--fin de row-->

        <div class="row">
            <div class="col-md-12">
                <div class="control-group">
                    <label class="control-label" for="MotivoDeComision">Agentes</label>
                    <table id="tableAgentes@(hash)" class="table table-hover table-advance table-bordered">
                        <thead>
                            <tr>
                                <th style="width:25%">
                                    <input type="text" id="txtAgente@(hash)" class="form-control col-md-12" tabindex="1" placeholder="Seleccione Agente" /><br />
                                    <p class="help-block"></p>
                                    <input type="hidden" id="Agente@(hash)" name="Agente" />
                                </th>
                                <th style="width:5%">
                                    Afiliado
                                </th>
                                <th style="width:8%">
                                    Días
                                </th>
                                <th style="width:8%">
                                    $ día
                                </th>
                                <th style="width:8%">
                                    Total Sol.
                                </th>
                                <th style="width:8%">
                                    Total días
                                </th>
                                <th style="width:8%">
                                    Gast.Sol
                                </th>
                                <th style="width:8%">
                                    Viat.Sol
                                </th>
                                <th style="width:8%">
                                    Gastos Rend.
                                </th>
                                <th style="width:8%">
                                    Total
                                </th>
                                <th style="width:8%">
                                    Anticipo
                                </th>
                                <th style="width:8%">
                                    Cobrar
                                </th>
                                <th style="width:8%">
                                    Devolver
                                </th>
                            </tr>
                        </thead>
                        <tbody id="bodyAgentes@(hash)"></tbody>
                        <tfoot>
                            <tr>
                                <th colspan="7">
                                    TOTALES
                                </th>
                                <th>
                                    <span id="TotalViatico@(hash)">0</span>
                                </th>
                                <th>
                                    <span id="TotalGastos@(hash)">0</span>
                                </th>
                                <th>
                                    <span id="TotalTotal@(hash)">0</span>
                                </th>
                                <th>
                                    <span id="TotalAnticipo@(hash)">0</span>
                                </th>
                                <th>
                                    <span id="TotalCobrar@(hash)">0</span>
                                </th>
                                <th>
                                    <span id="TotalDevolver@(hash)">0</span>
                                </th>
                            </tr>
                        </tfoot>
                    </table>
                    @*<table id="tableAgentes@(hash)" class="table table-hover table-advance table-bordered">
            <thead>
                <tr>
                    <th style="width:25%">
                        <input type="text" id="txtAgente@(hash)" class="form-control col-md-12" tabindex="1" placeholder="Seleccione Agente" /><br />
                        <p class="help-block"></p>
                        <input type="hidden" id="Agente@(hash)" name="Agente" />
                    </th>
                    <th style="width:5%">
                        Afiliado
                    </th>
                    <th style="width:8%">
                        Días
                    </th>
                    <th style="width:8%">
                        $ día
                    </th>
                    <th style="width:8%">
                        Total
                    </th>
                    <th style="width:8%">
                        Gastos
                    </th>
                    <th style="width:8%">
                        Total
                    </th>
                    <th style="width:8%">
                        Anticipo
                    </th>
                    <th style="width:8%">
                        Cobrar
                    </th>
                    <th style="width:8%">
                        Devolver
                    </th>
                </tr>
            </thead>
            <tbody id="bodyAgentes@(hash)"></tbody>
            <tfoot>
                <tr>
                    <td colspan="5">
                        TOTALES
                    </td>
                    <td>
                        <span id="TotalGastos@(hash)">0</span>
                    </td>
                    <td>
                        <span id="TotalTotal@(hash)">0</span>
                    </td>
                    <td>
                        <span id="TotalAnticipo@(hash)">0</span>
                    </td>
                    <td>
                        <span id="TotalCobrar@(hash)">0</span>
                    </td>
                    <td>
                        <span id="TotalDevolver@(hash)">0</span>
                    </td>
                </tr>
            </tfoot>
        </table>*@
                </div>
            </div>
        </div>
        <!--fin de row-->
        @*<div class="row">
                <div class="col-md-12">
                    <div class="control-group">
                        <label class="control-label" for="Expediente">Expediente</label>
                        <div class="controls">
                            <input type="text" class="form-control col-md-12" id="Expediente@(hash)" name="Expediente" tabindex="16" value="@Model.Expediente" )" />
                        </div>
                    </div>
                </div>
            </div>*@
        <!--fin de row-->
        @*<div class="row">
                <div class="col-md-12">
                    <div class="control-group">
                        <label class="control-label" for="Identificador">Identificador</label>
                        <div class="controls">
                            <input type="text" class="form-control col-md-12" id="Identificador@(hash)" name="Identificador" tabindex="17" value="@Model.Identificador" )" />
                        </div>
                    </div>
                </div>
            </div>*@

        <div class="modal fade" id="ModalGastos" role="basic" aria-hidden="true">
            <div class="modal-dialog modal-wide">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                        <h4 class="modal-title">Detalle de Gastos</h4>
                    </div>
                    <div class="modal-body">
                        <table class="table table-hover table-bordered">
                            <thead>
                                <tr>
                                    <th>
                                        @*<input type="text" id="txtconcepto_gastos@(hash)" class="form-control" placeholder="Conceptos"/>
                                        <input type="hidden" id="concepto_gastos@(hash)"/>*@
                                        <select id="concepto_gastos@(hash)" class="form-control">
                                            @foreach (var x in new SSO.SGP.AccesoADatos.ConceptosDeGastosRefAD().ObtenerOptions(""))
                                            {
                                                <option value="@x.value">@x.text</option>
                                            }
                                        </select>
                                    </th>
                                    <th>
                                        <input type="text" class="form-control" id="importe_gastos@(hash)" placeholder="Importe" />
                                    </th>
                                    <th>
                                        <a href="#" class="btn btn-info" id="guardar_gastos@(hash)">Guardar</a>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="body_gastos@(hash)"></tbody>
                            <tfoot>
                                <tr>
                                    <th>
                                        <a href="#" class="btn btn-success" id="listo_gastos@(hash)">Listo</a>
                                    </th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <div id="parsered" style="display:none"></div>
        <div class="modal fade" id="ImprimirRendicionModal" role="basic" aria-hidden="true">
            <div class="modal-dialog modal-wide">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                        <h4 class="modal-title">Solicitud</h4>
                    </div>
                    <div class="modal-body">
                        <input type="text" id="TextoSolicitud@(hash)" class="col-md-12 form-control" />
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <div class="form-actions">
        @if (Request.QueryString["op"] != "ver")
        {
            <input type="hidden" id="FechaAlta@(hash)" value="@Model.FechaDeAlta.ToShortDateString()" />
            <input type="hidden" id="SolicitudDeViatico@(hash)" value="@ViewBag.Solicitud" />
            <input type="hidden" id="Destino@(hash)" value="@ViewBag.Destino" />
            <input type="hidden" id="Id@(hash)" value="@ViewBag.Id" />
            <input type="button" value="Cancelar" id="Cancelar@(hash)" name="Cancelar" class="btn red" />
            <input type="button" value="Guardar Borrador" id="Guardar@(hash)" name="Guardar" class="btn green" />
            <input type="button" value="Guardar y Confirmar" id="GuardarYConfirmar@(hash)" name="GuardarYNuevo" class="btn blue" />
            <input type="button" value="Imprimir" id="Imprimir@(hash)" name="Imprimir" class="btn yellow" />
        }        
        </div><!--fin form-actions>-->
    </div>
}
<script type="text/javascript">
    $(function () {
        app.Desbloquear();
    });
    var viewEditarRendicion = new SolicitudesDeViaticos.ts.CrearRendicion("@(hash)");
    oSolicitudesDeViaticos.setEditarRendicion(viewEditarRendicion);
</script>
