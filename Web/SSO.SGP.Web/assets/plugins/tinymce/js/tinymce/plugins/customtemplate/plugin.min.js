tinymce.PluginManager.add('customtemplate', function (editor, url) {
    var myButton = null;
    var myEditor = editor;
    // Add a button that opens a window
    editor.addButton('customtemplate', {
        text: 'My button',
        icon: false,
        onclick: function () {
            // Open window
            //editor.windowManager.open({
            //    title: 'Example plugin',
            //    body: [
            //      { type: 'textbox', name: 'title', label: 'Title' }
            //    ],
            //    onsubmit: function (e) {
            //        // Insert content when the window form is submitted
            //        editor.insertContent('Title: ' + e.data.title);
            //    }
            //});
            editor.execCommand('mceInsertContent', false, "some text");
        }
    });

    // Adds a menu item to the tools menu
    editor.addMenuItem('customtemplate', {
        text: 'Custom Template TT',
        onPostRender: function () { myButton = this; },
        context: 'tools',
        onclick: function () {
            // Open window with a specific url
            editor.execCommand('mceInsertContent', false, "Texto de prueba");
        }
    });

    editor.on('NodeChange', function (event) {
        console.log("cambia node change: " + myEditor.selection.getNode().nodeName);
        if (myButton) {
            myButton.disabled((
                myEditor.selection.getNode().nodeName == 'A'));
        }
    });
});