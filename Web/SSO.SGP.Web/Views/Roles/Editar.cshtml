@using Syncrosoft.Framework.Controles.MVC.Script;
@using Syncrosoft.Framework.Controles.Mvc.JQuery.Datatables;
@using SSO.SGP.Web.Controllers;
@using Syncrosoft.Framework.Controles.MVC;
@using SSO.SGP.EntidadesDeNegocio.Vistas;
@model SSO.SGP.EntidadesDeNegocio.webpages_Roles

<!--
    CODE GENERATED BY Xeus Technology
    Date:  27/9/2016 12:38:49 p. m.
    Version: 3
-->
@{
    Layout = null;
    var hash = "form" + Session.GetHashCode();
    var value = "";
}
<!-- SCRIPTS -->
<!-- <script src="ts/webpages_Roles/Editar.js"></script> -->
<!-- /SCRIPTS -->

@using (Html.BeginForm("Editar", "Roles", FormMethod.Post, new { id = hash }))
{
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6">

                <div class="control-group">
                    <label class="control-label" for="Descripcion">Nombre del Rol</label>
                    <div class="controls">
                        <input type="text" class="form-control col-md-12" id="Descripcion@(hash)" name="Descripcion" tabindex="2" value="@((Model!=null ) ? ((Model.RoleName != null) ? Model.RoleName.ToString() : "") : "")" />
                    </div>
                </div>

            </div>

            <div class="col-md-6">

                <div class="control-group">
                    <label class="control-label" for="Descripcion">Menu Inicial</label>
                    <div class="controls">
                        <select id="MenuInicial@(hash)" name="MenuInicial" class="form-control select2">
                            @foreach (var item in (List<SSO.SGP.EntidadesDeNegocio.Menus>)ViewBag.Menues)
                            {
                                if (item.Padre == null)
                                {
                                    <optgroup label="@item.Label">

                                        @foreach (var item2 in (List<SSO.SGP.EntidadesDeNegocio.Menus>)ViewBag.Menues)
                                        {
                                            var idMenuInicial = item2.Padre.ToString() + "_" + item2.Id.ToString();
                                            //var idMenuInicial = item.Id;//item2.Padre.ToString() + "_" + item2.Id.ToString();
                                            if (item2.Padre.HasValue && item2.Padre.Value == item.Id)
                                            {
                                                if (Model != null)
                                                {
                                                    if (Model.ItemMenuDefault == idMenuInicial)
                                                    {
                                                        <option selected value="@idMenuInicial">@item2.Label</option>
                                                    }
                                                    else
                                                    {
                                                        <option value="@idMenuInicial">@item2.Label</option>
                                                    }
                                                }
                                                else
                                                {
                                                    <option value="@idMenuInicial">@item2.Label</option>
                                                }

                                            }
                                        }
                                    </optgroup>
                                }
                            }
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="control-group">
                    <h4 class="block">
                        Seleccionar Opciones del Menú para este Rol
                    </h4>
                    <table id="tablaRolesMenus" class="table table-striped table-bordered table-advance table-hover" data-sort="true">
                        <thead>
                            @*<tr>
                                    <th style="width: 10%"></th>
                                    <th style="width: 90%"></th>
                                </tr>*@
                        </thead>
                        <tbody>
                            @foreach (var item in (List<SSO.SGP.EntidadesDeNegocio.Menus>)ViewBag.Menues)
                            {
                                if (item.Padre == null)
                                {
                                    <tr>
                                        <td colspan="2" class="bg-blue">
                                            <strong>@item.Label</strong>
                                        </td>
                                    </tr>
                                    foreach (var item2 in (List<SSO.SGP.EntidadesDeNegocio.Menus>)ViewBag.Menues)
                                    {
                                        if (item2.Padre.HasValue && item2.Padre.Value == item.Id)
                                        {
                                            <tr>
                                                <td style="width: 10%">
                                                    @if (Model.Menus.Where(m => m.Id == item2.Id).Count() > 0)
                                                    {
                                                        <input type="checkbox" class="form-control col-md-12" data-id="@item2.Id" data-tipo="menu" checked="checked" />
                                                    }
                                                    else
                                                    {
                                                        <input type="checkbox" class="form-control col-md-12" data-id="@item2.Id" data-tipo="menu" />
                                                    }
                                                </td>
                                                <td style="width: 90%">@item2.Label</td>
                                            </tr>
                                        }
                                    }

                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <input type="hidden" id="Id@(hash)" name="Id" value="@Model.RoleId" />


        <div class="form-actions">

            <input type="button" value="Cancelar" id="Cancelar@(hash)" name="Cancelar" class="btn red" />

            <input type="button" value="Guardar" id="Guardar@(hash)" name="Guardar" class="btn green" />
        </div><!--fin form-actions>-->
    </div>
}
<script type="text/javascript">
    $(function () {
        app.Desbloquear();
    });
	var viewEditar = new Roles.ts.Editar("@(hash)");
    oRoles.setEditar(viewEditar);
</script>